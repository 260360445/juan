var page = 1,
    pagesize = 10;
tableId = "#winTable";
$(function () {

    tableId = "#cloudTable";
    $(".b_record_title li").unbind("click");
    $(".b_record_title li").click(function () {
        var c = $(this).index(".b_record_title li");
        $(this).addClass("b_record_this").siblings().removeClass("b_record_this");
        c++;
        loadCloudList(c)
    });
    loadCloudList(1);
    $(".c_money_type i").hover(function () {
        $(this).parents(".c_income").find(".c_tips_context").show()
    }, function () {
        $(".c_tips_context").hide()
    })
});


function bindMemberCenterAds(c) {
    if (c.status) {
        c = c.ads;
        var a = "",
            d;
        for (d = 0; d < c.length; d++) var e = c[d],
            a = a + "\x3cli\x3e",
            a = a + ('\x3ca href\x3d"' + e.link + '" target\x3d"_blank"\x3e'),
            a = a + ('\x3cimg src\x3d"' + e.img + '"/\x3e'),
            a = a + "\x3c/a\x3e",
            a = a + "\x3c/li\x3e";
        $("#memberCenterAds").html(a);
        $("#c_rotary").flexslider({
            animation: "slide",
            direction: "horizontal",
            easing: "swing"
        });
        $(".flex-control-nav").css({
            width: ($(".flex-control-nav li").width() + 10) * d
        })
    }
}

function loadCloudList(c) {
    ajaxMemberCloudRecord({
        page: 1,
        status: c,
        size: 3
    }, bindCloudRecordList)
}

function bindCloudRecordList(c, a) {
    var d = a.speedCid;
    $(".b_record_block").html(a.countYG[0]);
    $(".b_record_block1").html(a.countYG[1]);
    $(".b_record_block2").html(a.countYG[2]);
    var e = a.mid;
    $("#status").val(a.status);
    var b;
    b = '\x3ctr class\x3d"b_part_title"\x3e\x3cth class\x3d"b_th1"\x3e\u5546\u54c1\u56fe\u7247\x3c/th\x3e\x3cth class\x3d"b_th2"\x3e\u5546\u54c1\u540d\u79f0\x3c/th\x3e\x3cth class\x3d"b_th3"\x3e\u593a\u5b9d\u72b6\u6001\x3c/th\x3e\x3cth class\x3d"b_th4"\x3e\u53c2\u4e0e\u4eba\u6b21\x3c/th\x3e\x3cth class\x3d"b_th5"\x3e\u593a\u5b9d\u53f7\u7801\x3c/th\x3e\x3cth class\x3d"b_th6"\x3e\u64cd\u4f5c\x3c/th\x3e\x3c/tr\x3e';
    if (1 == a.status) {
        if ($("font").attr("color", ""), $("#b1").attr("color", "#dd2726"), $("#count_1").wrapInner("\x3cstrong\x3e\x3c/strong\x3e"), 0 < a.pageModelList.totalPage)
            for (i = 0; i < a.memberYgList.length; i++) {
                var g = "";
                d && d == a.memberYgList[i].cid && (g += "\x3cem style\x3d'background-color:#ff2300;padding: 3px 5px;color: #fff;font-size: 12px;'\x3e\u6781\u901f\u4e13\u533a\x3c/em\x3e");
                b += "\x3ctr\x3e";
                var f = a.memberYgList[i].goods_price / a.memberYgList[i].price_area,
                    e = a.memberYgList[i].selled_time,
                    h = e / f * 100,
                    h = 0 === h || 1 <= h ? h : 1;
                b += '\x3ctd\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e\x3cimg src\x3d"' + imageGoodsPath + a.memberYgList[i].gthumb.split(",", 1) + '" alt\x3d"" /\x3e\x3c/a\x3e\x3c/td\x3e';
                b += '\x3ctd id\x3d"div_' + i + '"\x3e\x3cdiv class\x3d"b_goods_name"\x3e\x3cspan\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e' + g + "(\u7b2c" + a.memberYgList[i].buy_period + "\u671f)" + a.memberYgList[i].gtitle;
                b += '\x3c/a\x3e\x3c/span\x3e\x3cb class\x3d"b_all_require"\x3e\u603b\u9700\uff1a' + f + "\u4eba\u6b21\x3c/b\x3e";
                b += '\x3cdiv class\x3d"b_progress_bar"\x3e\x3cem style\x3d"width:' + h + '%;"\x3e\x3c/em\x3e\x3c/div\x3e\x3cdl class\x3d"b_progress"\x3e\x3cdd class\x3d"b_progress_left"\x3e\x3cspan\x3e';
                b += e;
                b += '\x3c/span\x3e\x3cb\x3e\u5df2\u53c2\u4e0e\x3c/b\x3e\x3c/dd\x3e\x3cdd class\x3d"b_progress_center"\x3e\x3cspan\x3e';
                b += f + '\x3c/span\x3e\x3cb\x3e\u603b\u9700\u4eba\u6b21\x3c/b\x3e\x3c/dd\x3e\x3cdd class\x3d"b_progress_right"\x3e';
                b += "\x3cspan\x3e" + (f - e) + "\x3c/span\x3e\x3cb\x3e\u5269\u4f59\x3c/b\x3e\x3c/dd\x3e\x3c/dl\x3e";
                b += '\x3cb style\x3d"color:#888;" class\x3d"time' + i + '"\x3e\u593a\u5b9d\u65f6\u95f4\uff1a' + formatDate(a.memberYgList[i].buy_time, "yyyy-MM-dd HH:mm:ss.S") + "\x3c/b\x3e\x3c/div\x3e";
                b += '\x3c/td\x3e\x3ctd class\x3d"b_color"\x3e\u6b63\u5728\u8fdb\u884c...\x3c/td\x3e\x3ctd\x3e\x3ctt class\x3d"times' + i + '"\x3e' + a.memberYgList[i].buy_times;
                b += '\x3c/tt\x3e\u4eba\u6b21\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')" class\x3d"b_follow_buy"\x3e\u8ddf\u4e70\x3c/a\x3e\x3c/td\x3e';
                b = "" == a.memberYgList[i].buy_codes ? b + "\x3ctd\x3e\u65e0\x3c/td\x3e" : b + ("\x3ctd\x3e" + getNo(a.memberYgList[i].buy_codes, i) + "\x3c/td\x3e");
                b += '\x3ctd\x3e\x3ctt id\x3d"refund_' + a.memberYgList[i].id + '"\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e\u67e5\u770b\u8be6\u60c5\x3e\x3c/a\x3e';
                b += "\x3c/td\x3e\x3c/tr\x3e"
            }
    } else if (2 == a.status) {
        if ($("font").attr("color", ""), $("#b2").attr("color", "#dd2726"), $("#count_2").wrapInner("\x3cstrong\x3e\x3c/strong\x3e"), 0 < a.pageModelList.totalPage)
            for (i = 0; i < a.memberYgList.length; i++) g = "", d && d == a.memberYgList[i].cid && (g += "\x3cem style\x3d'background-color:#ff2300;padding: 3px 5px;color: #fff;font-size: 12px;'\x3e\u6781\u901f\u4e13\u533a\x3c/em\x3e"), b += "\x3ctr\x3e", f = a.memberYgList[i].gprice / a.memberYgList[i].price_area, b += '\x3ctd\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e\x3cimg src\x3d"' + imageGoodsPath + a.memberYgList[i].gthumb.split(",", 1) + '" alt\x3d"" /\x3e\x3c/a\x3e\x3c/td\x3e', b += '\x3ctd id\x3d"div_' + i + '"\x3e\x3cdiv class\x3d"b_goods_name" \x3e\x3cspan\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e' + g + "(\u7b2c" + a.memberYgList[i].buy_period + "\u671f)" + a.memberYgList[i].gtitle, b += '\x3c/a\x3e\x3c/span\x3e\x3cb class\x3d"b_all_require"\x3e\u603b\u9700\uff1a' + f + "\u4eba\u6b21\x3c/b\x3e", b += '\x3cdiv class\x3d"b_progress_bar"\x3e\x3cem style\x3d"width:100%;"\x3e\x3c/em\x3e\x3c/div\x3e\x3cdl class\x3d"b_progress"\x3e\x3cdd class\x3d"b_progress_left"\x3e\x3cspan\x3e', b += f, b += '\x3c/span\x3e\x3cb\x3e\u5df2\u53c2\u4e0e\x3c/b\x3e\x3c/dd\x3e\x3cdd class\x3d"b_progress_center"\x3e\x3cspan\x3e', b += f + '\x3c/span\x3e\x3cb\x3e\u603b\u9700\u4eba\u6b21\x3c/b\x3e\x3c/dd\x3e\x3cdd class\x3d"b_progress_right"\x3e', b += "\x3cspan\x3e0\x3c/span\x3e\x3cb\x3e\u5269\u4f59\x3c/b\x3e\x3c/dd\x3e\x3c/dl\x3e", b += '\x3cb style\x3d"color:#888;" class\x3d"time' + i + '"\x3e\u593a\u5b9d\u65f6\u95f4\uff1a' + formatDate(a.memberYgList[i].buy_time, "yyyy-MM-dd HH:mm:ss.S") + "\x3c/b\x3e\x3c/div\x3e", b += '\x3c/td\x3e\x3ctd class\x3d"b_color"\x3e\u7b49\u5f85\u63ed\u6653\x3c/td\x3e\x3ctd class\x3d"times' + i + '"\x3e' + a.memberYgList[i].buy_times + "\u4eba\u6b21\x3c/td\x3e", b += "\x3ctd\x3e" + getNo(a.memberYgList[i].buy_codes, i) + "\x3c/td\x3e", b += '\x3ctd\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e\u67e5\u770b\u8be6\u60c5\x3e\x3c/a\x3e\x3c/td\x3e', b += "\x3c/tr\x3e"
    } else if (3 == a.status && ($("font").attr("color", ""), $("#b3").attr("color", "#dd2726"), $("#count_3").wrapInner("\x3cstrong\x3e\x3c/strong\x3e"), 0 < a.pageModelList.totalPage))
        for (i = 0; i < a.memberYgList.length; i++) g = "", d && d == a.memberYgList[i].cid && (g += "\x3cem style\x3d'background-color:#ff2300;padding: 3px 5px;color: #fff;font-size: 12px;'\x3e\u6781\u901f\u4e13\u533a\x3c/em\x3e"), b += "\x3ctr\x3e", f = a.memberYgList[i].gprice / a.memberYgList[i].price_area, b += '\x3ctd\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e\x3cimg src\x3d"' + imageGoodsPath + a.memberYgList[i].gthumb.split(",", 1) + '" alt\x3d"" /\x3e\x3c/a\x3e\x3c/td\x3e', b += '\x3ctd id\x3d"div_' + i + '"\x3e\x3cdiv class\x3d"b_goods_name" id\x3d"" \x3e\x3cspan\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e' + g + "(\u7b2c" + a.memberYgList[i].buy_period + "\u671f)" + a.memberYgList[i].gtitle + "\x3c/a\x3e\x3c/span\x3e", b += "\x3c/a\x3e\x3c/span\x3e\x3cb\x3e\u603b\u9700\uff1a" + f + "\u4eba\u6b21\x3c/b\x3e", b = e == a.memberYgList[i].user_id ? b + ("\x3cp\x3e\u83b7\u5f97\u8005\uff1a" + a.memberYgList[i].user_nickname + "\uff08\u672c\u671f\u5171\u53c2\u4e0e\x3cem\x3e" + a.memberYgList[i].user_yg_count + "\x3cem\x3e\u4eba\u6b21\uff09") : b + ('\x3cp\x3e\u83b7\u5f97\u8005\uff1a\x3ca href\x3d"/other/recordBuy/' + a.memberYgList[i].user_id + '.html"\x3e' + a.memberYgList[i].user_nickname + "\x3c/a\x3e\uff08\u672c\u671f\u5171\u53c2\u4e0e\x3cem\x3e" + a.memberYgList[i].user_yg_count + "\x3cem\x3e\u4eba\u6b21\uff09"), b += '\x3cp\x3e\u5e78\u8fd0\u53f7\u7801\uff1a\x3ci class\x3d"win' + i + '"\x3e' + a.memberYgList[i].user_win_code + "\x3c/i\x3e\x3c/p\x3e", b += '\x3cp class\x3d"c_know_time"\x3e\u63ed\u6653\u65f6\u95f4\uff1a\x3ci\x3e' + formatDate(a.memberYgList[i].publish_time, "yyyy-MM-dd HH:mm:ss.S") + "\x3c/i\x3e\x3c/p\x3e", b += '\x3cb style\x3d"color:#888;" class\x3d"time' + i + '"\x3e\u593a\u5b9d\u65f6\u95f4\uff1a' + formatDate(a.memberYgList[i].buy_time, "yyyy-MM-dd HH:mm:ss.S") + '\x3c/b\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"c_person_color"\x3e\u5df2\u63ed\u6653\x3c/td\x3e\x3ctd class\x3d"times' + i + '"\x3e' + a.memberYgList[i].buy_times + "\u4eba\u6b21\x3c/td\x3e", b += "\x3ctd\x3e" + getNo(a.memberYgList[i].buy_codes, i) + "\x3c/td\x3e", b += '\x3ctd\x3e\x3ca href\x3d"javascript:gotoGoods(' + a.memberYgList[i].gid + "," + a.memberYgList[i].buy_period + ')"\x3e\u67e5\u770b\u8be6\u60c5\x26gt;\x3c/a\x3e\x3c/td\x3e', b += "\x3c/tr\x3e";
    0 < a.pageModelList.totalPage ? $("#cloudTable").html(b) : isNull("no_record", "cloudTable", 165, "/goods/allCat.do");
    pageCount = a.pageModelList.totalPage;
    page = a.pageModelList.page;
    cloudListPage(c)
}

function cloudListPage(c) {
    $("#pageCloud").createPage({
        pageCount: pageCount,
        current: page,
        backFn: function (a) {
            c.page = a;
            ajaxMemberCloudRecord(c, bindCloudRecordList)
        }
    })
}

function getNo(c, a) {
    for (var d = c.split(","), e = "", b = 0; 7 > b && b < d.length; b++) e += "\x3ci\x3e" + d[b] + " \x3c/i\x3e";
    e = e.replace(/\"/g, "");
    e = e.replace("[", "");
    e = e.replace("]", "");
    return 7 > d.length ? "\x3cdiv class\x3d'b_cloud_code'\x3e" + e + "\x3cspan class\x3d'code" + a + "' style\x3d'display:none'\x3e" + c + "\x3c/span\x3e\x3c/div\x3e" : "\x3cdiv class\x3d'b_cloud_code'\x3e" + e + "\x3cspan class\x3d'code" + a + "' style\x3d'display:none'\x3e" + c + "\x3c/span\x3e\x3ca href\x3d'javascript:void(0);' onclick\x3d'more(" + a + ");' class\x3d'b_periods_num'\x3e\u67e5\u770b\u66f4\u591a\x26gt;\x3c/a\x3e\x3c/div\x3e"
}

function more(c) {
    var a = $(".win" + c).text();
    $("#b_cloud_window .m-detail-codesDetail-wrap").html("");
    $("#b_cloud_window h3").html('\u60a8\u672c\u671f\u603b\u5171\u53c2\u4e0e\u4e86\x3cspan class\x3d"txt-red"\x3e' + $(".times" + c).text().replace("\u4eba\u6b21", "") + "\x3c/span\x3e\u4eba\u6b21");
    var d = [],
        e = [];
    d.push('\x3cdl class\x3d"m-detail-codesDetail-list f-clear"\x3e');
    d.push("\x3cdt\x3e" + $(".time" + c).text() + "\x3c/dt\x3e");
    e = $(".code" + c).text().replace("[", "").replace("]", "").replace(/"/g, "").split(",");
    $(e).each(function (b, c) {
        c != a ? d.push("\x3cdd\x3e" + c + "\x3c/dd\x3e") : d.push('\x3cdd class\x3d"txt-red selected"\x3e' + c + "\x3c/dd\x3e")
    });
    d.push("\x3c/dl\x3e");
    $("#b_cloud_window .m-detail-codesDetail-wrap").html(d.join(""));
    $("#b_cloud_window").css({
        left: ($(window).width() - $("#b_cloud_window").width()) / 2,
        top: ($(window).height() - $("#b_cloud_window").height()) / 2
    });
    $("#b_cloud_window").show();
    $(".b_msgbox_bj").height($("body").height());
    $(".b_msgbox_bj").show()
}

function closeCodesPane() {
    $("#b_cloud_window").hide();
    $(".b_msgbox_bj").hide()
}

function setTime(c) {
    c = 0 == c ? {
        status: $("#status").val(),
        size: 3
    } : {
        status: $("#status").val(),
        time: c,
        size: 3
    };
    ajaxMemberCloudRecord(c, bindCloudRecordList)
}

function actionSearch() {
    var c = $("#startTime").val(),
        a = $("#endTime").val();
    "" == c ? layer.tips("\u8bf7\u9009\u62e9\u5f00\u59cb\u65f6\u95f4!", "#startTime") : "" == a ? layer.tips("\u8bf7\u9009\u62e9\u7ed3\u675f\u65f6\u95f4!", "#endTime") : a < c ? layer.tips("\u5f00\u59cb\u65f6\u95f4\u5e94\u8be5\u5c0f\u4e8e\u7ed3\u675f\u65f6\u95f4!", "#endTime") : (c = {
        status: $("#status").val(),
        stareTime: c,
        endTime: a,
        size: 3
    }, ajaxMemberCloudRecord(c, bindCloudRecordList))
};