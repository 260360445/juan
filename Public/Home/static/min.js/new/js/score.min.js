$(function () {
    scoreExchange()
});

function scoreExchange() {
    $(window).resize(function () {
        var c = $("body").height(),
            d = $(window).width(),
            b = $(window).height();
        $(".c_exchange_bg").css({
            height: c + "px"
        });
        $(".c_recharge_remind").css({
            left: (d - $(".c_recharge_remind").outerWidth()) / 2 + "px",
            top: (b - $(".c_recharge_remind").outerHeight()) / 2 + "px"
        });
        $(".c_exchange_box").css({
            top: (b - $(".c_exchange_box").outerHeight()) / 2 + "px"
        });
        $(".a_score_exchange").click(function () {
            $.ajax({
                type: "post",
                url: "/member/score/scoreToYgbRule.do",
                dataType: "json",
                success: function (a) {
                    a.status ? ($(".c_exchange_bg").show(), $(".c_exchange_coin").show(), $("#rule_show").html("\u5151\u6362\u6bd4\u4f8b:" + a.perScore + "\u79ef\u5206\u53ef\u5151\u6362" + a.ygbCount + "\u5143"), $("#scoreBalanceC").html(a.scoreBalance), $("#scoreConvertibleMoney").html(parseInt(a.scoreBalance / a.perScore)), $("#h_core_balance").val(a.scoreBalance), $("#h_score_convert_rule").val(a.perScore), $("#scoreConvertToken").val(a.scoreConvertToken)) : alert(a.msg)
                }
            })
        });
        $(".c_exchange_new_close").click(function () {
            $(".c_exchange_bg").hide();
            $(".c_exchange_coin").hide()
        });
        $(".c_cancel").click(function () {
            $(".c_exchange_bg").hide();
            $(".c_exchange_coin").hide()
        });
        $(".c_exchange_add_close").click(function () {
            $(".c_exchange_bg").hide();
            $(".c_exchange_box").hide()
        });
        $(".c_exchange_ture").click(function () {
            $(".c_exchange_bg").hide();
            $(".c_exchange_box").hide()
        });
        $(".c_exchange_btn").click(function () {
            var a = $("#input_ygb").val(),
                b = $("#h_core_balance").val(),
                c = $("#h_score_convert_rule").val(),
                d = /^[0-9]*[1-9][0-9]*$/;
            null == a || "" == a ? layer.tips("\u8bf7\u8f93\u5165\u5151\u6362\u91d1\u989d!", "#input_ygb") : 1 > a ? layer.tips("\u6700\u5c11\u5151\u63621\u5143!", "#input_ygb") : d.test(a) ? a * c > b ? layer.tips("\u53ef\u5151\u6362\u79ef\u5206\u4e0d\u8db3!", "#input_ygb") : $.ajax({
                type: "post",
                url: "/member/score/memberScoreConvertYgb.do",
                dataType: "json",
                data: {
                    inputYgb: a,
                    scoreConvertToken: $("#scoreConvertToken").val()
                },
                success: function (a) {
                    a.status ? ($(".c_exchange_box").show(), $(".c_exchange_coin").hide(), $("#input_ygb").val(""), a = {
                        page: 1,
                        pageSize: pageSize
                    }, ajaxScoreSourceDetail(), ajaxScoreResourceList(a, bindScoreResource), ajaxScoreConsumeDetail(), ajaxScoreConsumerList(a, bindScoreConsumer)) : 0 == a.status && ("form-recommit" == a.code || "form-token-failure" == a.code || "session-token-failure" == a.code ? alerts("\u63d0\u793a", "\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5!", "350", "150") : $("#error_msg").html(a.msg))
                }
            }) : layer.tips("\u53ea\u80fd\u8f93\u5165\u6b63\u6574\u6570!", "#input_ygb")
        })
    });
    $(window).resize()
};