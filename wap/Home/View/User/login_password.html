<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta name="keywords" content="<?php echo $_SESSION['sc']['infor']['keywords']?>">
<meta name="description" content="<?php echo $_SESSION['sc']['infor']['description']?>">
<link rel="shortcut icon" href="/<?php echo $_SESSION['sc']['infor']['ico']?>" type="image/x-icon" /> 
<link rel="stylesheet" href="__PUBLIC__/Wap/css/base.css">
<link rel="stylesheet" href="__PUBLIC__/Wap/css/anquan/login_password.css">
<title>登录密码</title>
<style>
ul li input{
	width: 6.5rem;
}
</style>
</head>
<body>
	<header>
		<a href="javascript:window.history.back();"><img src="__PUBLIC__/Wap/images/anquan/come_back.png" alt=""></a>
		<h3>登录密码</h3>
	</header>
	<form action="">
		<ul>
			<li>
				<h3>原密码</h3>
				<input type="password" placeholder="请输入原密码" id="passwordOld" maxlength="20">
			</li>
			<li>
				<h3>新密码</h3>
				<input type="password" placeholder="8-20位字符，至少包含字母+数字" id="newpassword" maxlength="20">
			</li>
			<li class="no_border">
				<h3>确认密码</h3>
				<input type="password" placeholder="8-20位字符，至少包含字母+数字" id="repassword" maxlength="20">
			</li>
			<li>
				<button type="button" id="updatePassword">修改</button>
			</li>
		</ul>
	</form>
</body>
<script type="text/javascript" src="__PUBLIC__/Wap/js/jquery.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Wap/js/base.js"></script>
<script src="__PUBLIC__/Wap/js/layer/layer.js"></script>
<script>
$("#updatePassword").click(function () {
    var url = "<{:U('User/updatePass')}>";
    var a = $("#passwordOld").val();
    var b = $("#newpassword").val();
    var c = $("#repassword").val();
    var d = /(?!^(\d+|[a-zA-Z]+|[~!@#$%^&*?]+)$)^[\w~!@#$%\^&*?]{8,20}$/;
    if("" == a){
    	layer.open({
	        content: '\u539f\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }else if("" == b){
    	layer.open({
	        content: '\u65b0\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }else if(!d.test(b)){
    	layer.open({
	        content: '\u5bc6\u7801\u957f\u5ea68~20\u4f4d,\u7531\u82f1\u6587\u3001\u6570\u5b57\u7ec4\u6210!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }else if("" == c){
    	layer.open({
	        content: '\u786e\u8ba4\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }else if( b != c){
    	layer.open({
	        content: '\u786e\u8ba4\u5bc6\u7801\u4e0e\u65b0\u5bc6\u7801\u4e0d\u4e00\u81f4!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }
    $.ajax({
        type: "post",
        url: url,
        dataType: "json",
        data: {
            oldPass: $("#passwordOld").val(),
            pass: $("#newpassword").val(),
            repass: $("#repassword").val(),
        },
        success: function (a) {
            if(a == 2){
                layer.open({
			        content: '设置成功!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
			    setTimeout(function () { test(); }, 2005); 
            }else if(a==3){
                layer.open({
			        content: '\u539f\u5bc6\u7801\u9519\u8bef!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
	    		return false;
            }else if(a == 4){
                $("#repassword").val("");
                layer.open({
			        content: '\u786e\u8ba4\u5bc6\u7801\u4e0e\u65b0\u5bc6\u7801\u4e0d\u4e00\u81f4!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
	    		return false;
            }else if(a == 5){
                layer.open({
			        content: '\u5bc6\u7801\u4fee\u6539\u5931\u8d25!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
	    		return false;
            }
        }
    })
});
function test(){
	window.location.reload();
}
</script>
</html>