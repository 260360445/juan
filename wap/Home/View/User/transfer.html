<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<script type="text/javascript" src="__PUBLIC__/Wap/js/base.js"></script>
<link rel="stylesheet" href="__PUBLIC__/Wap/css/base.css">
<title>转账管理</title>
</head>
<style type="text/css">
	body{
		background-color: #f5f5f5;
		padding: 1.5rem 0;
	}
	ul{
		margin-top: .3rem;
	}
	ul li{
		background-color: #fff;
		margin-bottom: .3rem;
		padding: .2rem .5rem;
		font-size: .4rem;
		color: #4d4d4d;
	}
	ul li p{
		line-height: 1rem;
	}
	ul li p .check_pending{
		color: #dd2726;
	}
	ul li p .reject{
		color: #999;
	}
	ul li p .pass{
		color: #008000;
	}
	footer{
		width: 100%;
		position: fixed;
		bottom: 0;
		left: 0;
	}
	footer a{
		display: block;
		width: 100%;
		height: 100%;
		background-color: #dd2726;
		font-size: .5rem;
		color: #fff;
		text-align: center;
		line-height: 1.5rem;
	}
	.shipments_top{
		padding: 0 0 0 .4rem;
	    background-color: #fff;
	    overflow: hidden;
	    padding-right: .4rem;
	    border-top: 1px solid #e6e6e6;
	    border-bottom: 1px solid #e6e6e6;
	}
	.more{
	    width: 100%;
	    color: #ddd;
	    margin: 10px 0;
	    border-radius: 2px;
	    font-size: 20px;
	    text-align: center; 
	    display: none;
	}
</style>
<body>
	<header>
		<a href="javascript:window.history.back();"><img src="__PUBLIC__/Wap/images/user/come_back.png" alt=""></a>
		<h3>转账管理</h3>
	</header>
	<div class="shipments_top">
		<p style="color:#ff3a4b;font-size:14px;">
		温馨提示:单笔转账100-30000另:转账前请仔细检查对方手机号码,以免造成不必要的损失!
		</p>
	</div>
	<ul id="pro">
	<volist name="info" id="list">
		<li>
			<p>流水号：<span><{$list.number}></span></p>
			<p>接收账户：<span><{$list.mobile}></span></p>
			<p>转账金额：<span><{$list.money}></span></p>
			<p>提现时间：<span><{:date('Y-m-d H:i:s',$list[ztime])}></span></p>
			<p>状态：<span >
				<if condition="$list[status] eq 2">
                    <font style="color:green;">成功</font>
                <elseif condition="$list[status] eq 3"/>
                    <font style="color:#999;">失败</font>
                </if>
			</span></p>
		</li>
	</volist>	
	</ul>
	<!-- 滚动加载 -->
    <?php if(!empty($info)){?>
        <div class="more" style="width:100%;height:30px;">
           <img alt="loading" src="__PUBLIC__/Wap/images/loading2.gif" style="height:30px">
        </div>
    <?php }?>
    <!-- 滚动加载 -->
	<footer>
		<a href="<{:U('User/dotran')}>">转账</a>
	</footer>
</body>
<script type="text/javascript" src="__PUBLIC__/Wap/js/jquery.min.js"></script>
<script src="__PUBLIC__/Wap/js/layer/layer.js"></script>
<script type="text/javascript">
var page = 0;
var is_loading = false;
$(function(){
//滚动加载
    var stop = true;
    $(window).scroll(function () {
        if ((screen.height + $(window).scrollTop()) >= $(document).height()) {
            if (stop == true) {
                stop = false;
                $(".more").show();
                if(!is_loading){
                    more();
                }
            };  
        }
    });
    function more(){
        is_loading = true;
        var ApiUrl =  "<{:U('User/listpage')}>";
        page++;
        $.ajax({
            url:ApiUrl,
            type: 'POST',
            dataType: 'JSON',
            data:{page:page,type:7},
            success:function(data){
                if (data == '') {
                    $('.more').text('没有更多记录了');
                }else{
                    is_loading = false;
                    var li = ""
                    for (var i = 0; i < data.length; i++) {
                        li +='<li>';
							li +='<p>流水号：<span>'+data[i]['number']+'</span></p>';
							li +='<p>接收账户：<span>'+data[i]['mobile']+'</span></p>';
							li +='<p>转账金额：<span>'+data[i]['money']+'</span></p>';
							li +='<p>转账时间：<span>'+getTime(data[i].ztime)+'</span></p>';
							li +='<p>状态：<span >';
								if(data[i]['status'] == 2){
									li +='<font style="color:green;">成功</font>';
								}else if(data[i]['status'] == 3){
									li +='<font style="color:#999;">失败</font>';
								}
							li +='</span></p>';
						li +='</li>';
                    };
                    $('#pro').append(li);
                }
                stop = true;
            }
        })
    }
//滚动加载结束
})
function getTime(/** timestamp=0 **/) {
  var ts = arguments[0] || 0;
  var t,y,m,d,h,i,s;
  t = ts ? new Date(ts*1000) : new Date();
  y = t.getFullYear();
  m = t.getMonth()+1;
  d = t.getDate();
  h = t.getHours();
  i = t.getMinutes();
  s = t.getSeconds();
  // 可根据需要在这里定义时间格式
  return y+'-'+(m<10?'0'+m:m)+'-'+(d<10?'0'+d:d)+' '+(h<10?'0'+h:h)+':'+(i<10?'0'+i:i)+':'+(s<10?'0'+s:s);
} 
</script>
</html>