<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta name="keywords" content="<?php echo $_SESSION['sc']['infor']['keywords']?>">
<meta name="description" content="<?php echo $_SESSION['sc']['infor']['description']?>">
<link rel="shortcut icon" href="/<?php echo $_SESSION['sc']['infor']['ico']?>" type="image/x-icon" /> 
<link rel="stylesheet" href="__PUBLIC__/Wap/css/base.css">
<link rel="stylesheet" href="__PUBLIC__/Wap/css/anquan/login_password.css">
<title>支付密码</title>
</head>
<body>
	<header>
		<a href="javascript:window.history.back();"><img src="__PUBLIC__/Wap/images/anquan/come_back.png" alt=""></a>
		<h3>支付密码</h3>
	</header>
	<form action="">
		<ul>
			<li>
				<h3>原支付密码</h3>
				<input type="password" id="oldPayPass" maxlength="6" placeholder="请输入原密码">
			</li>
			<li>
				<h3>新支付密码</h3>
				<input type="password" id="newPaypass" maxlength="6" placeholder="请输入原密码">
			</li>
			<li class="no_border">
				<h3>确认密码</h3>
				<input type="password" id="resNewPaypass" maxlength="6" placeholder="请再次输入新密码">
			</li>
			<li>
				<button type="button" id="c_apy_step2">确定</button>
			</li>
		</ul>
	</form>
</body>
<script type="text/javascript" src="__PUBLIC__/Wap/js/jquery.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Wap/js/base.js"></script>
<script src="__PUBLIC__/Wap/js/layer/layer.js"></script>
<script type="text/javascript">
$("#c_apy_step2").click(function () {
    var url = "<{:U('User/updateNewPayPass')}>";
    var a = $("#oldPayPass").val();
    var b = $("#newPaypass").val();
    var c = $("#resNewPaypass").val();
    var d = /^\d{6}$/;
    if("" == a){
    	layer.open({
	        content: '\u539f\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }
    if("" == b){
    	layer.open({
	        content: '\u65b0\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }else if(!d.test(b)){
    	layer.open({
	        content: '请输入6位数字密码!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }
    if("" == c){
    	layer.open({
	        content: '\u786e\u8ba4\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }
    if(b != c){
    	layer.open({
	        content: '两次密码不一致!'
	        ,skin: 'msg'
	        ,time: 2 //2秒后自动关闭
	    });
	    return false;
    }
    $.ajax({
        type: "post",
        url: url,
        dataType: "json",
        data: {
            oldPass: $("#oldPayPass").val(),
            pass: $("#newPaypass").val(),
            repass: $("#resNewPaypass").val(),
        },
        success: function (a) {
            if(a == 2){
            	layer.open({
			        content: '设置成功!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
			    setTimeout(function () { test(); }, 2005); 
            }else if(a==3){
                $("#oldPayPass").val("");
                $("#oldPayPass").focus();
                layer.open({
			        content: '\u539f\u5bc6\u7801\u9519\u8bef!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
			    return false;
            }else if(a == 4){
            	$("#resNewPaypass").val("");
                layer.open({
			        content: '两次密码不一致!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
			    return false;
            }else if(a == 5){
                layer.open({
			        content: '\u5bc6\u7801\u4fee\u6539\u5931\u8d25!'
			        ,skin: 'msg'
			        ,time: 2 //2秒后自动关闭
			    });
			    return false;
            }
        }
    })
});
function test(){
	window.location.href="<{:U('User/save')}>";
}
</script>
</html>