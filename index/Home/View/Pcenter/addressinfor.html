<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="robots" content="" />
<meta name="author" content="网页作者的资料"/>
<meta name="keywords" content="<?php echo $_SESSION['sc']['infor']['keywords']?>"></meta>
<meta name="description" content="<?php echo $_SESSION['sc']['infor']['description']?>"></meta>
<link rel="shortcut icon" href="/<?php echo $_SESSION['sc']['infor']['ico']?>" type="image/x-icon" /> 
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE"/> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="renderer" content="webkit"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/new/css/header_footer.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/new/css/member_comm.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/new/css/b_member.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/new/css/c_member.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/min.css/new/css/header_footer.min.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/min.css/new/css/member.min.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/min.css/css/front/new_join.min.css"/>
<link rel="stylesheet" href="__PUBLIC__/Home/static/new/css/member_comm.css"/>
<title>个人中心--收货地址--方大商城</title>
<style type="text/css">
  .c_address_in{
  height:528px;
  }
  .c_address{
  padding-left:14px;
  }
  .c_form_con{
  width:785px;
  }
  .c_form_con label{
  width:115px;
  }
  select{
     background: transparent;
     appearance:none;
      -moz-appearance:none;
      -webkit-appearance:none;
     width: 180.5px;
     height: 34px;
     -webkit-appearance: none;
     margin-left: -10px;
     margin-top: 2px;
     border-width:0px;
     line-height: 34px;
     font-size:14px;
     padding-right: 40px;
  }
  .select_showbox{
     overflow: hidden;
  }
  select::-ms-expand { display: block; }

  .c_out_a i, .c_first_out_a i {
      background: rgba(0, 0, 0, 0) url("/Public/Home/static/new/img/icon/member_comm/left_icon.png") no-repeat scroll 0 0;
  }

  .aa div{
      margin-top: 14px;
  }
  .aa div p{
      position: relative;

  }
  .c_form_con .aa div input.uploading{
    opacity: 0;
    width: 148px;
    height: 34px;
    position: absolute;
    top: 0;
    left: 0;
  }
  .aa div:first-child>span {
      position: relative;
      display: block;
  }
  .aa div:first-child span img{
      display: block;
      border: 1px solid #ccc;
  }
  .aa div:first-child span i{
      position: absolute;
      width: 20px;
      height: 20px;
      left: 155px;
      top: -10px;
      border-radius: 50%;
      line-height: 20px;
      text-align: center; 
      font-size: 14px;
      border: 1px solid #000; 
  }
  .aa div:first-child span img{
      width:160px;
      height: 160px;
  }
  .aa div:last-child span {
      position: relative;
      float: left;
      margin-right: 10px;
  }
  .aa div:last-child span img{
      border: 1px solid #ccc;
  }
  .aa div:last-child span i{
      position: absolute;
      width: 20px;
      height: 20px;
      right: -10px;
      top: -10px;
      border-radius: 50%;
      line-height: 20px;
      text-align: center; 
      font-size: 14px;
      border: 1px solid #000; 
  }
  .aa div:last-child span img{
      width:80px;
      height: 80px;
  }
  #back.toolbar-item{
    visibility: visible !important;
}
.r-fixed{
    visibility: visible !important;
}
</style>
</head>
<body>
  <!-- S 头部 -->
  <!-- 引入头部 -->
   <include file="public:phead" />
    <!-- 引入头部 -->
  <!-- E 头部 -->
  <!-- S 内容区域 -->
  <div class="b_sup_content">
      <!-- S 会员资料 -->
      <!--S 头部 -->
      <include file="public:pminHead" />
      <!-- E 会员资料 -->
      <div id="content_box" class="">
        <!-- S 左侧 -->
        <include file="public:pleft" />
        <!-- E 左侧 -->
        <!-- S 右侧 -->
        <div id="member_right" class="member_right">
        <div class="c_address_top"><span></span>
          <if condition="$addcount eq 1 ">
                      已保存1条地址，还能保存3条地址
          <elseif condition="$addcount eq 2 "/>
                      已保存2条地址，还能保存2条地址
          <elseif condition="$addcount eq 3 "/>
                      已保存3条地址，还能保存1条地址
          <elseif condition="$addcount eq 4 "/>
                      已保存3条地址，还能保存1条地址
          <else />
                  已保存0条地址，还能保存4条地址
          </if>
        </div>
        <!-- 数据列表栏 -->
        <div class="c_address" id="datalist">
        <form id="fbg">
        <div class="c_address">
                <div class="c_form_con">
                    <label>收货人地区：</label>
                    <ul class="c_form_right">
                        <li class="c_contact">
                            <div class="select_showbox">
                              <select style="display: block;" name="pro" id="province">
                                <option value="0">------请选择省------</option>
                                <volist name="province_arr" id="list">
                                  <option value="<{$list.id}>" ><{$list.name}></option>
                                </volist>
                              </select>
                            </div>
                        </li>
                        <li class="c_contact">
                            <div class="select_showbox" id="cityDiv">
                              <select style="display: block;" name="citys" id="city" >
                                <option value="0">------请选择市------</option>
                              </select>
                            </div>
                        </li>
                        <li class="c_contact">
                            <div class="select_showbox" id="areaDiv">
                              <select style="display: block;" name="areas" id="area">
                                <option value="0">------请选择区/县------</option>
                              </select>
                            </div>
                        </li>
                    </ul>
                    <div class="c_clear"></div>
                </div>

                <div class="c_form_con c_newform_con">
                    <label>收货人姓名：</label>
                    <div class="c_form_right">
                        <input class="c_details_address" type="text" name='name' placeholder="收货人姓名"  maxlength="4" />
                    </div>
                    <div class="c_clear"></div>
                </div>
                <div class="c_form_con c_newform_con">
                    <label>收货人电话：</label>
                    <div class="c_form_right">
                        <input class="c_details_address" type="text" name='mobile' placeholder="收货人电话"  maxlength="11" />
                    </div>
                    <div class="c_clear"></div>
                </div>
                <div class="c_form_con c_newform_con">
                    <label>详细收货地址：</label>
                    <div class="c_form_right">
                      <textarea class="c_details_address" placeholder="详细收货地址" id='street' style="border:1px solid #ddd;resize:none;height:50px;padding-left: 10px;"></textarea>
                    </div>
                    <div class="c_clear"></div>
                </div>
                <div class="c_form_con c_newform_con">
                    <label>设为默认地址：</label>
                    <div class="c_new_form_right">
                      <input type="radio"  value="2" name="sta" style="margin: 13px 0 0 10px;" checked="" />是
                      <input type="radio" value="3" name="sta" style="margin: 13px 0 0 10px;" />否
                    </div>
                    <div class="c_clear"></div>
                </div>
                <div class="c_form_con">
                  <label></label>
                      <div class="c_form_right">
                        <button class="c_save" style="display: block;" type="button">提交</button>
                      </div>
                </div>
          </div>
        </div>
      </form>
    </div>
    </div>
  </div>
  <!-- S 底部 -->
<include file="public:pfoot" />
<script type="text/javascript" src="__PUBLIC__/Home/static/js/jquery-1.11.3.js"></script>
<script type="text/javascript" src="__PUBLIC__/Home/static/min.js/js/include/footer_header_new.min.js"></script>
<script src="__PUBLIC__/Home/static/new/js/member_left.js"></script>
<script src="__PUBLIC__/Admin/javascripts/layer/layer.js"></script>
<script src="__PUBLIC__/Home/static/min.js/js/common_ajaxfunction_member_base.min.js"></script>
<script>
/*
 * 方法描述：编辑按钮点击事件
 * 参数：地址在已获取的地址列表中的序号
 */
$("#province").change(function(){
    var url = "<{:U('Pcenter/pro_city')}>";
    var procode=$(this).val();
    if(procode==0){
          var html = "<option value='0'>------请选择市------</option>"; 
          var html1 = "<option value='0'>------请选择区/县------</option>";         
          $('#city').html(html);
          $('#area').html(html1);
    }else{
        $.post(url,{procode:procode},function(data){
            /* alert(data); */
            $('#city').empty();
             var html = "<option value='0'>------请选择市------</option>";
            $.each(data, function(k,v){
                html += "<option value='" +v['id']+ "'>" + v['name'] + "</option>";
            });
            $('#city').html(html);
        },"json")
    }
    var html = "<option value='0'>------请选择市------</option>"; 
    var html1 = "<option value='0'>------请选择区/县------</option>";         
    $('#city').html(html);
    $('#area').html(html1);
})
$("#city").change(function(){
    var citycode=$(this).val();
    var url = "<{:U('Pcenter/city_area')}>";
    if(citycode==0){
         var html = "<option value='0'>------请选择区/县------</option>"; 
           $('#city').html(html);
    }else{
        $.post(url,{citycode:citycode},function(data){
                /* alert(data); */
            $('#area').empty();
                var html = "<option value='0'>------请选择区/县------</option>";
           $.each(data, function(k,v){
               html += "<option value='" +v['id']+ "'>" + v['name'] + "</option>";
           });
           $('#area').html(html);
        },"json")
    }
          var html1 = "<option value='0'>------请选择区/县------</option>";         
          $('#area').html(html1);
})
$(".c_save").click(function(){
  var name=$("input[name=name]").val();
  var mobile=$("input[name=mobile]").val();
  var street=$("#street").val();
  var pro_id=$("#province option:selected").val();
  var city_id=$("#city option:selected").val();
  var area_id=$("#area option:selected").val();
  var province = $("#province option:selected").text();//接到省
  var city = $("#city option:selected").text();//接到市
  var area = $("#area option:selected").text();//接到区/县
  var isdefault=$("input[name=sta]:checked").val();//接到默认地址标识
  if(pro_id == 0){
     layer.msg('请选择省',{offset: '300px',time: 1500,icon: 7});
     return false;
  }
  if(city_id == 0){
      layer.msg('请选择市',{offset: '300px',time: 1500,icon: 7});
     return false;
  }
  if(area_id == 0){
      layer.msg('请选择区/县',{offset: '300px',time: 1500,icon: 7});
     return false;
  }
  if(name == ''){
     layer.msg('请填写收货人姓名',{offset: '300px',time: 1500,icon: 7});
     return false;
  }
  if(mobile == ''){
     layer.msg('请填写收货人手机',{offset: '300px',time: 1500,icon: 7});
     return false;
  }
  if(mobile == ''){
     layer.msg('请填写具体收货地址',{offset: '300px',time: 1500,icon: 7});
     return false;
  }
  var url = "<{:U('Pcenter/setAddressInfo')}>";
  $.ajax({
      type: "post",
      url: url,
      dataType:'json',
      data:{
          uname :name ,
          province : province ,
          city:city,
          area:area,
          pro_id : pro_id ,
          city_id:city_id,
          area_id:area_id,
          street:street,
          mobile:mobile,
          isdefault:isdefault,
      },
      success:function(data){
        if(data=="ok"){//保存收货地址成功时
          layer.msg('修改成功',{offset: '300px',time: 1500,icon: 1},function () {
              window.location.href="<{:U('Pcenter/address')}>";
          });
        }else{//保存收货地址未成功时
          layer.msg(data,{offset: '300px',time: 1500,icon: 2});return false;
        }
      }
  });
})
</script>
<script>
function cartCount() {
    var url = "<{:U('Cart/cartCount')}>";
    $.ajax({
        url: url,
        type: 'POST',
        dataType: 'json',
        data: '',
        success:function(data){
            if(data > 0){
                $("#cartCount").html(data);
                $("#cartCount").addClass("num-rt");
                $("#row").html(data);
            }else{
                $("#cartCount").html("");
            }
        }
    });
}
function CartOrder(){
    var a = $("#mid").val();
    var b = $("#sta").val();
    if(null != a && "" != a){
        if(b == '2'){//账号处于激活状态
            window.location.href="<{:U('Cart/cart')}>"; 
        }else if(b == '3'){//账号处于冻结状态
            layer.msg('账号处于冻结状态,请联系管理员解封',{offset: '300px',time: 2000,icon: 7});
        }
    }
}
</script>
</body>
</html>
